{% extends "base.html" %}
{% load static %}

{% block extra_head %}
  <!-- Patient List Styles -->
  <link
    rel="stylesheet"
    href="{% static 'css/patient/patient.css' %}"
  >
  <!-- Bootstrap Icons -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
  >
{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-primary">ðŸ“‹ Patient List</h2>
    <a
      href="{% url 'patients:create_patient' %}"
      class="btn btn-primary"
    >
      âž• New Patient
    </a>
  </div>

  <div class="card shadow-sm p-3">
    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">Mobile</th>
            <th scope="col">Email</th>
            <th scope="col">Gender</th>
            <th scope="col">Prediction</th>
            <th scope="col" class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for patient in patients %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ patient.full_name }}</td>
            <td>{{ patient.mobile }}</td>
            <td>{{ patient.email }}</td>
            <td>{{ patient.get_gender_display }}</td>
            <td>
              {% if patient.diabetes_prediction == "Positive" %}
                <span class="badge bg-danger">Positive</span>
              {% elif patient.diabetes_prediction == "Negative" %}
                <span class="badge bg-success">Negative</span>
              {% else %}
                <span class="badge bg-secondary">Pending</span>
              {% endif %}
            </td>
            <td class="text-center">
              <a
                href="{% url 'patients:detail' patient.pk %}"
                class="btn btn-sm btn-info me-1"
                title="View"
              >
                <i class="bi bi-search"></i>
              </a>
              <a
                href="{% url 'patients:edit' patient.pk %}"
                class="btn btn-sm btn-warning"
                title="Edit"
              >
                <i class="bi bi-pencil"></i>
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center text-muted">
              No patients found.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  {# Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù…ÙŠÙ† pagination: #}
  {% if patients.has_other_pages %}
  <nav aria-label="Page navigation" class="mt-4">
    <ul class="pagination justify-content-center">
      {% if patients.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ patients.previous_page_number }}" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">&laquo;</span>
      </li>
      {% endif %}
      {% for num in patients.paginator.page_range %}
      <li class="page-item {% if patients.number == num %}active{% endif %}">
        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
      </li>
      {% endfor %}
      {% if patients.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ patients.next_page_number }}" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">&raquo;</span>
      </li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
</div>
{% endblock %}
