{% extends "base.html" %}
{% load static %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'css/appointments/edit_appointment.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="card shadow edit-appt-card">
    <div class="edit-appt-header text-center py-4 border-bottom">
      <h3 class="text-primary fw-bold">
        <i class="bi bi-pencil-square me-2"></i> Edit Appointment
      </h3>
      <p class="text-muted">Update the appointment details or delete it if needed.</p>
    </div>

    <!-- Main Form: Edit Appointment -->
    <form method="post" class="edit-appt-form p-4">
      {% csrf_token %}

      {% if form.errors %}
        <div class="alert alert-danger">
          <strong>Please fix the following errors:</strong>
          <ul class="mb-0 mt-2">
            {% for field in form %}
              {% for error in field.errors %}
                <li><strong>{{ field.label }}:</strong> {{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <div class="row g-4">
        <div class="col-md-6">
          <label for="{{ form.patient.id_for_label }}" class="form-label">Patient</label>
          {{ form.patient }}
        </div>

        <div class="col-md-6">
          <label for="{{ form.doctor.id_for_label }}" class="form-label">Doctor</label>
          {{ form.doctor }}
        </div>

        <div class="col-md-6">
          <label for="{{ form.scheduled_time.id_for_label }}" class="form-label">Appointment Time</label>
          {{ form.scheduled_time }}
        </div>

        <div class="col-md-6">
          <label for="{{ form.status.id_for_label }}" class="form-label">Status</label>
          {{ form.status }}
        </div>

        <!-- Amount in IQD -->
        <div class="col-md-6">
          <label for="{{ form.iqd_amount.id_for_label }}" class="form-label">Amount (IQD)</label>
          {{ form.iqd_amount }}
        </div>
      </div>

      <!-- Save Button -->
      <div class="text-end mt-4">
        <button type="submit" class="btn btn-success">
          <i class="bi bi-check-circle-fill me-2"></i> Save Changes
        </button>
      </div>
    </form>

   </div>
</div>
{% endblock %}

{% block extra_scripts %}
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    flatpickr(".datetimepicker", {
      enableTime: true,
      noCalendar: false,
      dateFormat: "Y-m-d h:i K",
      time_24hr: false
    });
  </script>
{% endblock %}
